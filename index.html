<!DOCTYPE html>
<html xmlns:v-bind="http://www.w3.org/1999/xhtml">
<head lang="en">
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Music in the Second Empire Theatre</title>

    <link href="css/bootstrap-4.0.0/bootstrap.css" rel="stylesheet">
    <link href="css/site.css" rel="stylesheet">
    <link href="css/switch.css" rel="stylesheet">

    <link rel="stylesheet" href="fontawesome-free-5/css/all.min.css">

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
    <script src="./js/html5shiv.min.js"></script>
    <script src="./js/respond.min.js"></script>
    <![endif]-->

    <script src="local.js"></script>

    <script src="js/vue.js"></script>
    <script src="js/vue-router.js"></script>
    <script src="js/vue-resource-1.5.1.js"></script>
    <script src="js/jquery.min.js"></script>
    <script src="js/bootstrap-4.0.0/bootstrap.min.js"></script>

</head>
<body>
<div class="container" id='page'>
    <nav class="row" id="navigation">
        <div class="col col1"><a href="/" class="navlinks">FMC Home</a></div>
        <div class="col col2"><a href="/project-description" class="navlinks"> Project Description</a></div>
        <div class="col col3"><a href="/collections" class="navlinks">Collections</a></div>
        <div class="col col4"><a href="http://search.fmc.ac.uk/" class="navlinks">Search Collections</a></div>
        <div class="col col5"><a
                href="http://search.fmc.ac.uk/#m-columnbrowser@||m-informationcontrol@url=html/help.php"
                class="navlinks m-href">Help</a></div>
    </nav>
    <div class="row" id="header">
        <img src="./assets/new-fmc-logo.jpg" alt="Header image"/>
    </div>
    <div class="row">
        <div class="col">
            <h1>Music in the Second Empire Theatre</h1>
        </div>
    </div>

    <div id="app"></div>

    <div class="row mt-2" id="footer">
        <div class="col-sm-6"><img src="./assets/soton.png" alt="University of Southampton logo"/></div>
        <div class="col-sm-6"><img src="./assets/cam.png" alt="University of Cambridge logo"/></div>
    </div>
</div>
</div>

<script type="text/x-template" id="templateApp">
    <div>
    <template v-if="app_status == 'dev'">
        <div class="row">
        <div class="col">
        <div class="card bg-warning mt-2">
          <div class="card-body">
             This is a development instance of this service.
          </div>
        </div>
        </div>
        </div>
    </template>
    <template v-if="app_status == 'pprd'">
        <div class="row">
        <div class="col">
        <div class="card bg-warning mt-2">
          <div class="card-body">
             This is the pre-production instance of this service.
          </div>
        </div>
        </div>
        </div>
    </template>
    
    <template v-if="source_data.status == 'ERROR'">
        <div class="row">
        <div class="col">
        <div class="card bg-error mt-2">
          <div class="card-body">
            <h2>Unable to load data</h2>
            <p>An error has occurred. The error was: {{ source_data.error_message }}.</p>
          </div>
        </div>
        </div>
        </div>
    </template>
    <template v-if="source_data.status == 'LOADING'">
        <div class="row">
        <div class="col">
        <div class="card bg-info mt-2">
          <div class="card-body">
            Please wait while the data loads.
          </div>
        </div>
        </div>
        </div>
    </template>
    <template v-if="source_data.status == 'OK'">
        <dataset v-bind:dataset="defaultDataset"></dataset>
    </template>
    </div>
</script>

<script type="text/x-template" id="templateDataset">
    <div>
        <nav class="row">
            <nav class="col">
                <p>
                    <router-link to="/">Dataset home</router-link>
                    |
                    <router-link to="/data">Dataset schema and download</router-link>
                </p>
            </nav>
        </nav>
        <router-view></router-view>
    </div>
</script>

<script type="text/x-template" id="templateHome">
    <form>
        <div class="row">
            <div class="col">
                <filter-form v-if="show_all_filters" v-bind:filters="filters"></filter-form>
                <filter-form v-else v-bind:filters="quick_filters"></filter-form>
            </div>
        </div>
        <div class="row" v-if="show_all_filters">
            <div class="col text-sm-right pb-3 pt-3">
                <button v-on:click="resetFilters" class="btn btn-secondary">Reset form</button>
            </div>
        </div>

        <div class="row">
            <div class="col-sm-6">
                Order results by 
                <select v-model="sort_field"><option v-for="field in sort_fields" v-bind:value="field.id">{{field.label}}</option></select>
                <select v-model="sort_dir"><option value="asc">Ascending</option><option value="desc">Decending</option></select>
            </div>
            <div class="col-sm-6 text-sm-right">
                <div class="switch switch-sm">
                  <input v-model="show_all_filters" type="checkbox" class="switch" id="show-all-filters" />
                  <label for="show-all-filters">Show all filters</label>
                </div>
            </div>
        </div>
        <div class="row">
            <div class="col">
                <results v-bind:results="filteredAndSortedResults()"></results>
            </div>
        </div>
    </form>
</script>

<script type="text/x-template" id="templateResults">
    <div>
        <div v-if="results.length == 0" class="card mb-1">
            <div class="card-body">No records match your filter terms.</div>
        </div>
        <div class="card mb-1">
            <div class="card-body">Showing {{ results.length }} record{{ (results.length==1?'':'s') }}.</div>
        </div>
        <div v-for="result in results">
            <summary-card v-bind:record="result"></summary-card>
        </div>
    </div>
</script>

<script type="text/x-template" id="templateFilterForm">
    <div class='filter-form'>
        <div v-for="filter in filters" class="form-row">
            <label class="col-sm-2 text-sm-right">{{filter.field.label}}</label>
            <template v-if="filter.field.type=='text'">
                <div class="col-sm-2">
                    <select v-model.trim="filter.mode" class="form-control form-control-sm">
                        <option value="is">is</option>
                        <option value="contains">contains</option>
                    </select>
                </div>
                <div class="col-sm-8">
                    <input v-model.trim="filter.term" class="form-control form-control-sm"/>
                </div>
            </template>
            <template v-else-if="filter.field.type=='integer'">
                <div class="col-sm-2">
                    <select v-model.trim="filter.mode" class="form-control form-control-sm">
                        <option value="is">is</option>
                        <option value="between">is between</option>
                    </select>
                </div>
                <div class="col-sm-8">
                    <template v-if="filter.mode=='is'">
                        <input v-model.number="filter.term" type="number" class="form-control form-control-sm"/>
                    </template>
                    <template v-if="filter.mode=='between'">
                        <input v-model.number="filter.term" type="number" class="form-control form-control-sm" style="display:inline-block;width:auto"/> and <input v-model.number="filter.term2"
                                                                                       type="number" class="form-control form-control-sm" style="display:inline-block;width:auto"/>
                    </template>
                </div>
            </template>
            <template v-else-if="filter.field.type=='date'">
                <div class="col-sm-2">
                    <select v-model.trim="filter.mode" class="form-control form-control-sm">
                        <option value="is">is</option>
                        <option value="between">is between</option>
                    </select>
                </div>
                <div class="col-sm-8">
                    <template v-if="filter.mode=='is'">
                        <input v-model.trim="filter.term" class="form-control form-control-sm"/>
                    </template>
                    <template v-if="filter.mode=='between'">
                        <input v-model.trim="filter.term" class="form-control form-control-sm" style="display:inline-block;width:auto"/> and <input v-model="filter.term2" class="form-control form-control-sm" style="display:inline-block;width:auto"/>
                    </template>
                </div>
            </template>
            <template v-else-if="filter.field.type=='enum'">
                <div class="col-sm-2">
                    <select v-model.trim="filter.mode" class="form-control form-control-sm">
                        <option value="is">is</option>
                        <option value="one-of">one of</option>
                    </select>
                </div>
                <div class="col-sm-8">
                <template v-if="filter.mode=='is'">
                    <select v-model="filter.term" class="form-control form-control-sm">
                        <option selected="selected" value="">Select</option>
                        <option v-for="option in filter.field.options" v-bind:value="option">{{ option }}</option>
                    </select>
                </template>
                <template v-if="filter.mode=='one-of'">
                    <select multiple="multiple" v-model="filter.terms" class="form-control form-control-sm">
                        <option v-for="option in filter.field.options" v-bind:value="option">{{ option }}</option>
                    </select>
                </template>
                </div>
            </template>
            <template v-else-if="filter.field.type=='freetext'">
                <div class="col-sm-10">
                    <input v-model.trim="filter.term" class="form-control form-control-sm" />
                </div>
            </template>
            <template v-else>
                <div class="col-sm-10">
                   Unknown filter type.
                </div>
            </template>
        </div>
    </div>
</script>

<script type="text/x-template" id="templateData">
    <div class="row">
        <div class="col">
            <h2>About the data</h2>
            <p>This dataset has been created and shared with the intention it should be reused. The fields in the
                dataset are described below.</p>
            <p>This data is copyright <a v-bind:href="config.copyright.url">{{ config.copyright.name }}</a> and may be reused under the <a v-bind:href="config.license.url">{{ config.license.name }}</a> license.</p>
            <p>This dataset was created by <span v-for="(creator, index) in config.creators"><span>{{ creator.name }}</span><span v-if="index+1 < config.creators.length">, </span></span>.</p>
            <p>If using this data, please attribute it as "{{ config.attribution.text }}" with a link to <a v-bind:href="config.attribution.url">{{config.attribution.url}}</a>.</p>
            <h2>Schema</h2>
            <p>Field types may be text, date, integer or enum. An enum field is short for enumerated, which means a
                limited set of terms rather than free text.</p>
            <table class="table">
                <thead>
                <tr>
                    <th scope="col">Field id</th>
                    <th scope="col">Field name</th>
                    <th scope="col">Field type</th>
                    <th scope="col">Description</th>
                </tr>
                </thead>
                <tbody>
                <tr v-for="field in getConfigFields()">
                    <td>{{ field.id }}</td>
                    <td>{{ field.label }}</td>
                    <td>{{ field.type }} <span v-if="field.multiple"> list</span></td>
                    <td>{{ field.description }}</td>
                </tr>
                </tbody>
            </table>
        </div>
    </div>
</script>

<script type="text/x-template" id="templateRecord">
    <div>
        <div class="row">
            <div class="col">
                <index-card v-if="records_by_id[ $route.params.id ]"
                            v-bind:record="records_by_id[ $route.params.id ]"></index-card>
                <div v-else>
                    <p>NO SUCH RECORD</p>
                </div>
            </div>
        </div>
    </div>
</script>

<script type="text/x-template" id="templateFieldLabelAndValueIfSet">
      <field-label-and-value v-if="typedValue.value != '' && typedValue.value != null && !(typeof typedValue.value=='array' && typedValue.value.length==0)" v-bind:typedValue="typedValue"></field-label-and-value>
</script>

<script type="text/x-template" id="templateFieldLabelAndValue">
    <div class="field-label-and-value">
      <template v-if="typedValue.field.value != ''">
        <div class="field-label">{{ typedValue.field.label }}</div>
        <field-value v-bind:typedValue="typedValue"></field-value>
      </template>
    </div>
</script>

<script type="text/x-template" id="templateSummaryCard">
    <div class="summary-card card mb-1">
            <div class="card-body" v-on:click="showIndexCard" title="See full details.">
                <div class="row pb-1">
                    <div class="col-sm-10 card-title">
                        <field-value v-bind:typedValue="record.title"></field-value>
                    </div>
                    <div class="col-sm-2">
                        <field-value v-bind:typedValue="record.date"></field-value>
                    </div>
                </div>
                <div class="row">
                    <div class="col">
                        <i class="fas fa-music pr-1" title="Composer"></i><span class="sr-only">Composer</span>
                        <field-value v-bind:typedValue="record.composer" class="pr-2"></field-value>
                        <i class="fas fa-pen pr-1" title="Authors"></i><span class="sr-only">Composer</span>
                        <field-value v-bind:typedValue="record.author"></field-value>
                    </div>

                </div>
            </div>

    </div>
</script>

<script type="text/x-template" id="templateIndexCard">
    <div class="card index-card">
        <div class="card-body">
            <h5 class="card-title">
                <field-value v-bind:typedValue="record.title"></field-value>
            </h5>
            <div class="row">
                <div class="col-md">
                    <field-label-and-value v-bind:typedValue="record.date"></field-label-and-value>
                    <field-label-and-value v-bind:typedValue="record.title"></field-label-and-value>
                    <field-label-and-value v-bind:typedValue="record.acts"></field-label-and-value>
                    <field-label-and-value v-bind:typedValue="record.genre"></field-label-and-value>
                    <br/>
                    <field-label-and-value-if-set v-bind:typedValue="record.numbers_act_1"></field-label-and-value-if-set>
                    <field-label-and-value-if-set v-bind:typedValue="record.numbers_act_2"></field-label-and-value-if-set>
                    <field-label-and-value-if-set v-bind:typedValue="record.numbers_act_3"></field-label-and-value-if-set>
                    <field-label-and-value v-bind:typedValue="record.total_numbers"></field-label-and-value>
                    <br/>
                    <field-label-and-value v-bind:typedValue="record.male"></field-label-and-value>
                    <field-label-and-value v-bind:typedValue="record.female"></field-label-and-value>
                    <field-label-and-value v-bind:typedValue="record.author"></field-label-and-value>
                    <field-label-and-value v-bind:typedValue="record.composer"></field-label-and-value>
                    <br/>
                    <field-label-and-value v-bind:typedValue="record.emplois_listed_in_vs"></field-label-and-value>
                    <field-label-and-value v-bind:typedValue="record.dance_number"></field-label-and-value>
                    <field-label-and-value v-bind:typedValue="record.melodrame"></field-label-and-value>
                </div>
                <div class="col-md">
                    <field-label-and-value v-bind:typedValue="record.institution"></field-label-and-value>
                    <field-label-and-value v-bind:typedValue="record.original_date"></field-label-and-value>
                    <field-label-and-value v-bind:typedValue="record.original_institution"></field-label-and-value>
                    <br/>
                    <field-label-and-value v-bind:typedValue="record.metteur_en_scene"></field-label-and-value>
                    <field-label-and-value v-bind:typedValue="record.libretto_publisher"></field-label-and-value>
                    <field-label-and-value v-bind:typedValue="record.libretto_total_pages"></field-label-and-value>
                    <br/>
                    <field-label-and-value v-bind:typedValue="record.vs_publisher"></field-label-and-value>
                    <field-label-and-value v-bind:typedValue="record.vs_arranger"></field-label-and-value>
                    <field-label-and-value v-bind:typedValue="record.vs_total_pages"></field-label-and-value>
                    <br/>
                    <field-label-and-value v-bind:typedValue="record.record_number"></field-label-and-value>
                </div>
            </div>
            <div class="row">
            </div class="col-md">
            (fields not in current example we're working from!)
            <field-label-and-value v-bind:typedValue="record.arranger"></field-label-and-value>
            <field-label-and-value v-bind:typedValue="record.original_author"></field-label-and-value>
            <field-label-and-value v-bind:typedValue="record.original_composer"></field-label-and-value>
            <field-label-and-value v-bind:typedValue="record.original_title"></field-label-and-value>
            <field-label-and-value v-bind:typedValue="record.tableaux"></field-label-and-value>
        </div>
    </div>
    </div>
    </div>
</script>

</body>
<script src="js/site.js"></script>
</html>

